{% extends "base.html" %}

{% block title %}–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - VK Ads Manager{% endblock %}

{% block content %}
<h2 style="color: #667eea; margin-bottom: 30px;">‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

<form action="{{ url_for('update_settings') }}" method="POST">
    
    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ -->
    <div class="card">
        <h3>üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏–∑–∞</h3>
        
        <div class="form-group">
            <label for="lookback_days">–ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ (–¥–Ω–µ–π)</label>
            <input type="number" id="lookback_days" name="lookback_days" value="{{ config.analysis_settings.lookback_days }}" min="1" max="90" required>
            <small class="small-text">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 7-14 –¥–Ω–µ–π)</small>
        </div>

        <div class="form-group">
            <label for="spent_limit_rub">–õ–∏–º–∏—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (‚ÇΩ)</label>
            <input type="number" step="0.01" id="spent_limit_rub" name="spent_limit_rub" value="{{ config.analysis_settings.spent_limit_rub }}" min="0" required>
            <small class="small-text">–ì—Ä—É–ø–ø—ã, –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏–µ –±–æ–ª—å—à–µ —ç—Ç–æ–≥–æ –ª–∏–º–∏—Ç–∞ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –±—É–¥—É—Ç –æ—Ç–∫–ª—é—á–µ–Ω—ã</small>
        </div>

        <div class="form-group">
            <label for="sleep_between_calls">–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (—Å–µ–∫)</label>
            <input type="number" step="0.01" id="sleep_between_calls" name="sleep_between_calls" value="{{ config.analysis_settings.sleep_between_calls }}" min="0" max="10" required>
            <small class="small-text">–ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ API –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0.25)</small>
        </div>

        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="dry_run" name="dry_run" {% if config.analysis_settings.dry_run %}checked{% endif %}>
                <label for="dry_run">–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (DRY RUN) - –Ω–µ –æ—Ç–∫–ª—é—á–∞—Ç—å –≥—Ä—É–ø–ø—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏</label>
            </div>
            <small class="small-text">–í —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –≥—Ä—É–ø–ø—ã –Ω–µ –±—É–¥—É—Ç —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã, —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç</small>
        </div>
    </div>

    <!-- Telegram –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div class="card">
        <h3>üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
        
        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="telegram_enabled" name="telegram_enabled" {% if config.telegram.enabled %}checked{% endif %}>
                <label for="telegram_enabled">–í–∫–ª—é—á–∏—Ç—å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label>
            </div>
        </div>

        <div class="form-group">
            <label for="telegram_bot_token">Bot Token</label>
            <input type="text" id="telegram_bot_token" name="telegram_bot_token" value="{{ config.telegram.bot_token }}">
            <small class="small-text">–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather</small>
        </div>

        <div class="form-group">
            <label for="telegram_chat_id">Chat ID</label>
            <input type="text" id="telegram_chat_id" name="telegram_chat_id" value="{{ config.telegram.chat_id }}">
            <small class="small-text">ID —á–∞—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ø–æ–ª—É—á–∏—Ç–µ —É @userinfobot)</small>
        </div>
    </div>

    <!-- –¢—Ä–∏–≥–≥–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="card">
        <h3>üéØ –¢—Ä–∏–≥–≥–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</h3>
        
        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="statistics_trigger_enabled" name="statistics_trigger_enabled" {% if config.statistics_trigger.enabled %}checked{% endif %}>
                <label for="statistics_trigger_enabled">–í–∫–ª—é—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä</label>
            </div>
            <small class="small-text">–ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç VK –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞)</small>
        </div>

        <div class="form-group">
            <label for="statistics_trigger_wait_seconds">–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (—Å–µ–∫)</label>
            <input type="number" id="statistics_trigger_wait_seconds" name="statistics_trigger_wait_seconds" value="{{ config.statistics_trigger.wait_seconds }}" min="5" max="60">
            <small class="small-text">–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–π –≥—Ä—É–ø–ø—ã</small>
        </div>
    </div>

    <!-- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ -->
    <div class="card">
        <h3>‚è∞ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á</h3>
        
        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="scheduler_enabled" name="scheduler_enabled" {% if config.scheduler.enabled %}checked{% endif %}>
                <label for="scheduler_enabled">–í–∫–ª—é—á–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</label>
            </div>
        </div>

        <div class="form-group">
            <label for="scheduler_interval_minutes">–ò–Ω—Ç–µ—Ä–≤–∞–ª –∑–∞–ø—É—Å–∫–∞ (–º–∏–Ω—É—Ç—ã)</label>
            <input type="number" id="scheduler_interval_minutes" name="scheduler_interval_minutes" value="{{ config.scheduler.interval_minutes }}" min="1" max="1440">
            <small class="small-text">–ö–∞–∫ —á–∞—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–Ω–∞–ª–∏–∑ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 60-120 –º–∏–Ω—É—Ç)</small>
        </div>

        <div class="form-group">
            <label for="scheduler_max_runs">–ú–∞–∫—Å–∏–º—É–º –∑–∞–ø—É—Å–∫–æ–≤</label>
            <input type="number" id="scheduler_max_runs" name="scheduler_max_runs" value="{{ config.scheduler.max_runs }}" min="0">
            <small class="small-text">0 = –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ</small>
        </div>

        <div class="form-group">
            <label for="scheduler_start_delay_seconds">–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (—Å–µ–∫)</label>
            <input type="number" id="scheduler_start_delay_seconds" name="scheduler_start_delay_seconds" value="{{ config.scheduler.start_delay_seconds }}" min="0" max="3600">
        </div>

        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="scheduler_retry_on_error" name="scheduler_retry_on_error" {% if config.scheduler.retry_on_error %}checked{% endif %}>
                <label for="scheduler_retry_on_error">–ü–æ–≤—Ç–æ—Ä—è—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö</label>
            </div>
        </div>

        <div class="form-group">
            <label for="scheduler_retry_delay_minutes">–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–≤—Ç–æ—Ä–∞ (–º–∏–Ω—É—Ç—ã)</label>
            <input type="number" id="scheduler_retry_delay_minutes" name="scheduler_retry_delay_minutes" value="{{ config.scheduler.retry_delay_minutes }}" min="1" max="60">
        </div>

        <div class="form-group">
            <label for="scheduler_max_retries">–ú–∞–∫—Å–∏–º—É–º –ø–æ–≤—Ç–æ—Ä–æ–≤</label>
            <input type="number" id="scheduler_max_retries" name="scheduler_max_retries" value="{{ config.scheduler.max_retries }}" min="0" max="10">
        </div>
    </div>

    <!-- –¢–∏—Ö–∏–µ —á–∞—Å—ã -->
    <div class="card">
        <h3>üåô –¢–∏—Ö–∏–µ —á–∞—Å—ã</h3>
        
        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="quiet_hours_enabled" name="quiet_hours_enabled" {% if config.scheduler.quiet_hours.enabled %}checked{% endif %}>
                <label for="quiet_hours_enabled">–í–∫–ª—é—á–∏—Ç—å —Ç–∏—Ö–∏–µ —á–∞—Å—ã</label>
            </div>
            <small class="small-text">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–µ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–Ω–∞–ª–∏–∑ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è</small>
        </div>

        <div class="form-group">
            <label for="quiet_hours_start">–ù–∞—á–∞–ª–æ —Ç–∏—Ö–∏—Ö —á–∞—Å–æ–≤</label>
            <input type="time" id="quiet_hours_start" name="quiet_hours_start" value="{{ config.scheduler.quiet_hours.start }}">
        </div>

        <div class="form-group">
            <label for="quiet_hours_end">–ö–æ–Ω–µ—Ü —Ç–∏—Ö–∏—Ö —á–∞—Å–æ–≤</label>
            <input type="time" id="quiet_hours_end" name="quiet_hours_end" value="{{ config.scheduler.quiet_hours.end }}">
        </div>
    </div>

    <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">‚ùå –û—Ç–º–µ–Ω–∞</a>
</form>
{% endblock %}

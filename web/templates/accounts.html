{% extends "base.html" %}

{% block title %}–ö–∞–±–∏–Ω–µ—Ç—ã - VK Ads Manager{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <h2 style="color: #667eea;">üè¢ –†–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã</h2>
    <button onclick="document.getElementById('addAccountForm').style.display='block'" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞–±–∏–Ω–µ—Ç</button>
</div>

<!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞ -->
<div id="addAccountForm" style="display: none; margin-bottom: 30px;">
    <div class="card">
        <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–±–∏–Ω–µ—Ç</h3>
        <form action="{{ url_for('add_account') }}" method="POST">
            <div class="form-group">
                <label for="account_name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–±–∏–Ω–µ—Ç–∞ *</label>
                <input type="text" id="account_name" name="account_name" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö—Ä–æ–∫–æ-1 ZK">
            </div>
            <div class="form-group">
                <label for="api_token">API —Ç–æ–∫–µ–Ω VK Ads *</label>
                <input type="text" id="api_token" name="api_token" required placeholder="–í–∞—à API —Ç–æ–∫–µ–Ω VK Ads">
                <small class="small-text">–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∫–∞–±–∏–Ω–µ—Ç–µ VK Ads</small>
            </div>
            <div class="form-group">
                <label for="trigger_id">ID —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–π –≥—Ä—É–ø–ø—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <input type="number" id="trigger_id" name="trigger_id" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 121435898">
                <small class="small-text">ID –≥—Ä—É–ø–ø—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ VK</small>
            </div>
            <div class="form-group">
                <label for="spent_limit">–õ–∏–º–∏—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ (‚ÇΩ, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <input type="number" step="0.01" id="spent_limit" name="spent_limit" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 100.0">
                <small class="small-text">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –¥–ª—è —ç—Ç–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–∏–π –ª–∏–º–∏—Ç</small>
            </div>
            <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button type="button" onclick="document.getElementById('addAccountForm').style.display='none'" class="btn btn-secondary">‚ùå –û—Ç–º–µ–Ω–∞</button>
        </form>
    </div>
</div>

<!-- –°–ø–∏—Å–æ–∫ –∫–∞–±–∏–Ω–µ—Ç–æ–≤ -->
{% if accounts %}
    <table>
        <thead>
            <tr>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–±–∏–Ω–µ—Ç–∞</th>
                <th>API —Ç–æ–∫–µ–Ω</th>
                <th>ID —Ç—Ä–∏–≥–≥–µ—Ä–∞</th>
                <th>–õ–∏–º–∏—Ç (‚ÇΩ)</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for name, data in accounts.items() %}
            <tr>
                <td><strong>{{ name }}</strong></td>
                <td><code style="font-size: 11px;">{{ data.api[:20] }}...{{ data.api[-10:] }}</code></td>
                <td>
                    {% if data.trigger %}
                        {{ data.trigger }}
                    {% else %}
                        <span class="small-text">–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</span>
                    {% endif %}
                </td>
                <td>
                    {% if data.spent_limit_rub %}
                        <strong>{{ data.spent_limit_rub }}‚ÇΩ</strong>
                    {% else %}
                        <span class="small-text">–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('edit_account', account_name=name) }}" class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                    <form action="{{ url_for('delete_account', account_name=name) }}" method="POST" style="display: inline;" onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–∞–±–∏–Ω–µ—Ç {{ name }}?')">
                        <button type="submit" class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="card">
        <p style="text-align: center; color: #666;">
            üì≠ –ö–∞–±–∏–Ω–µ—Ç—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –∫–∞–±–∏–Ω–µ—Ç" –≤—ã—à–µ.
        </p>
    </div>
{% endif %}
{% endblock %}

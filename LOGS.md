# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ª–æ–≥–∞–º VK Ads Manager

## –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–æ–≤

–í—Å–µ –ª–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/app/logs/` –≤–Ω—É—Ç—Ä–∏ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `vkads-backend`.

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `scheduler.log` | –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ª–æ–≥ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ |
| `vk_ads_manager_YYYYMMDD_HHMMSS.log` | –î–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ |
| `whitelist_stderr.log` | –û—à–∏–±–∫–∏ whitelist worker |

---

## üïê –õ–æ–≥ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (scheduler.log)

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
- –ù–æ–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞
- –í—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞
- –û—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞

### –ö–∞–∫ —á–∏—Ç–∞—Ç—å:

```powershell
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
docker exec vkads-backend cat /app/logs/scheduler.log | Select-Object -Last 50

# –°–ª–µ–¥–∏—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker exec vkads-backend tail -f /app/logs/scheduler.log

# –ß–µ—Ä–µ–∑ bash (–¥–ª—è Linux-–∫–æ–º–∞–Ω–¥)
docker exec vkads-backend bash -c "tail -100 /app/logs/scheduler.log"
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
2025-12-10 09:42:25 | INFO     | üîß VK Ads Scheduler –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
2025-12-10 09:42:25 | INFO     | üìÇ –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç: /app/core/main.py
2025-12-10 09:42:25 | INFO     | üïê VK Ads Scheduler –∑–∞–ø—É—â–µ–Ω
2025-12-10 09:42:25 | INFO     |    –ò–Ω—Ç–µ—Ä–≤–∞–ª: 1 –º–∏–Ω—É—Ç
2025-12-10 09:42:26 | INFO     | üìä –ó–∞–ø—É—Å–∫ #1
2025-12-10 09:42:26 | INFO     | üöÄ –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π...
2025-12-10 09:42:28 | INFO     | ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞ 1.6 —Å–µ–∫
2025-12-10 09:42:28 | INFO     | ‚è∞ –°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫: 2025-12-10 12:43:28
```

---

## üìã –õ–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∞ (vk_ads_manager_*.log)

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- –ê–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –±–∞–Ω–Ω–µ—Ä—É
- –£–±—ã—Ç–æ—á–Ω—ã–µ/—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ API

### –ö–∞–∫ —á–∏—Ç–∞—Ç—å:

```powershell
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
docker exec vkads-backend bash -c "ls -lah /app/logs/vk_ads_manager*.log | tail -10"


# –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–æ–≥
docker exec vkads-backend bash -c "cat /app/logs/vk_ads_manager_*.log | tail -200"

# –ù–∞–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å
docker exec vkads-backend cat /app/logs/vk_ads_manager_20251210_094226.log
```

### –ü–æ–∏—Å–∫ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

```powershell
# –ù–∞–π—Ç–∏ –æ—à–∏–±–∫–∏
docker exec vkads-backend bash -c "grep ERROR /app/logs/vk_ads_manager_*.log | tail -20"

# –ù–∞–π—Ç–∏ —É–±—ã—Ç–æ—á–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
docker exec vkads-backend bash -c "grep –£–ë–´–¢–û–ß–ù–û–ï /app/logs/vk_ads_manager_*.log"

# –ù–∞–π—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
docker exec vkads-backend bash -c "grep '–ø—Ä–∞–≤–∏–ª –æ—Ç–∫–ª—é—á–µ–Ω–∏—è' /app/logs/vk_ads_manager_*.log"

# –ù–∞–π—Ç–∏ –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
docker exec vkads-backend bash -c "grep -E '–£–±—ã—Ç–æ—á–Ω—ã—Ö|–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö|–í—Å–µ–≥–æ' /app/logs/vk_ads_manager_*.log"
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
2025-12-10 09:42:27 | INFO     | üìã [–ö—Ä–æ–∫–æ-1 ZK] –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–∞–≤–∏–ª –æ—Ç–∫–ª—é—á–µ–Ω–∏—è: 2
2025-12-10 09:42:27 | INFO     |    üìå –ü—Ä–∞–≤–∏–ª–æ "–ø—Ä–∞–≤–∏–ª–æ 0": spent >= 100.0, goals = 0.0
2025-12-10 09:42:27 | INFO     |    üìå –ü—Ä–∞–≤–∏–ª–æ "–ü—Ä–∞–≤–∏–ª–æ 1": spent >= 300.0, goals < 3.0
2025-12-10 09:42:27 | INFO     | üè¢ –ö–∞–±–∏–Ω–µ—Ç: –ö—Ä–æ–∫–æ-1 ZK
2025-12-10 09:42:27 | INFO     | üìÖ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–∏–æ–¥: 2025-11-30 ‚Äî 2025-12-10 (10 –¥–Ω–µ–π)
2025-12-10 09:42:27 | INFO     | ‚úÖ [–ö—Ä–æ–∫–æ-1 ZK] –ü–æ–ª—É—á–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π: 26
2025-12-10 09:42:27 | INFO     | üî¥ [–ö—Ä–æ–∫–æ-1 ZK] –£–ë–´–¢–û–ß–ù–û–ï: [194909350] –ö–æ–ø–∏—è_4 –ö–æ–ø–∏—è –æ–±_‚Ññ28
2025-12-10 09:42:27 | INFO     |    –ü—Ä–∞–≤–∏–ª–æ "–ø—Ä–∞–≤–∏–ª–æ 0": spent=154.32‚ÇΩ (>= 100), goals=0 (= 0)
2025-12-10 09:42:28 | INFO     | üî¥ –£–±—ã—Ç–æ—á–Ω—ã—Ö (–ø–æ –ø—Ä–∞–≤–∏–ª–∞–º): 3
2025-12-10 09:42:28 | INFO     | üü¢ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö: 5
```

---

## üîç API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

### –°—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
```powershell
Invoke-RestMethod -Uri "http://localhost:8000/api/control/status" | ConvertTo-Json
```

–û—Ç–≤–µ—Ç:
```json
{
  "scheduler": { "running": true, "pid": 66 },
  "analysis": { "running": false, "pid": null },
  "bot": { "running": false, "pid": null }
}
```

### –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
```powershell
Invoke-RestMethod -Uri "http://localhost:8000/api/control/scheduler/start" -Method POST
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
```powershell
Invoke-RestMethod -Uri "http://localhost:8000/api/control/scheduler/stop" -Method POST
```

---

## üìå –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–∞–Ω–Ω–µ—Ä–æ–≤ –≤ –ª–æ–≥–∞—Ö

| –ò–∫–æ–Ω–∫–∞ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| üî¥ –£–ë–´–¢–û–ß–ù–û–ï | over_limit | –ü–æ–¥–ø–∞–¥–∞–µ—Ç –ø–æ–¥ –ø—Ä–∞–≤–∏–ª–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è |
| üü¢ –≠–§–§–ï–ö–¢–ò–í–ù–û–ï | under_limit | –ï—Å—Ç—å VK —Ü–µ–ª–∏ (goals >= 1) |
| ‚ö†Ô∏è –¢–ï–°–¢–ò–†–£–ï–¢–°–Ø | no_activity | –†–∞—Å—Ö–æ–¥—ã –µ—Å—Ç—å, –Ω–æ –Ω–µ –ø–æ–¥–ø–∞–¥–∞–µ—Ç –ø–æ–¥ –ø—Ä–∞–≤–∏–ª–∞ |
| üîî –ü—Ä–æ–ø—É—Å–∫–∞–µ–º | whitelisted | –í –±–µ–ª–æ–º —Å–ø–∏—Å–∫–µ |

---

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```powershell
# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10)
docker exec vkads-backend bash -c "cd /app/logs && ls -t vk_ads_manager_*.log | tail -n +11 | xargs rm -f"

# –†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
docker exec vkads-backend bash -c "du -sh /app/logs/*"

# –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –Ω–∞ —Ö–æ—Å—Ç
docker cp vkads-backend:/app/logs ./logs_backup

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
Invoke-RestMethod -Uri "http://localhost:8000/api/control/scheduler/stop" -Method POST
Invoke-RestMethod -Uri "http://localhost:8000/api/control/scheduler/start" -Method POST
```

---

## ‚ö†Ô∏è –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `HTTP 404 adgroupresource` | –¢—Ä–∏–≥–≥–µ—Ä –≥—Ä—É–ø–ø—ã –Ω–µ –Ω–∞–π–¥–µ–Ω | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID —Ç—Ä–∏–≥–≥–µ—Ä–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–∞–±–∏–Ω–µ—Ç–∞ |
| `–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª` | –ö–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞ |
| `spent_limit is not defined` | –ë–∞–≥ –≤ –∫–æ–¥–µ | –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –±—ç–∫–µ–Ω–¥–∞ |
| `0 –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π` | –ù–µ—Ç —Ä–µ–∫–ª–∞–º—ã –≤ –∫–∞–±–∏–Ω–µ—Ç–µ | –ù–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∫–∞–±–∏–Ω–µ—Ç –ø—É—Å—Ç–æ–π |

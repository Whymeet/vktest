# –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏–π

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –ë–î.

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**
- ‚úÖ –í–∫–ª—é—á–∏–ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å –≤ –ë–î —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `running`
- üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏ —Å–µ—Ä–≤–µ—Ä ‚Üí –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∏–ª—Å—è
- ‚õî –í—ã–∫–ª—é—á–∏–ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å –≤ –ë–î —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `stopped`
- üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏ —Å–µ—Ä–≤–µ—Ä ‚Üí –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ù–ï –≤–∫–ª—é—á–∏–ª—Å—è

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É `process_states`:
- –ï—Å–ª–∏ `status='running'` ‚Üí –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ `status='stopped'` ‚Üí –ø—Ä–æ—Ü–µ—Å—Å –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é** (—Å–º. —Ä–∞–∑–¥–µ–ª "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏")
2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä**
3. –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `auto_start` –≤ —Ç–∞–±–ª–∏—Ü—É `process_states` –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

**SQL –º–∏–≥—Ä–∞—Ü–∏—è**: `migrations/add_scheduler_autostart.sql`

```sql
ALTER TABLE process_states
ADD COLUMN IF NOT EXISTS auto_start BOOLEAN DEFAULT FALSE;

CREATE INDEX IF NOT EXISTS ix_process_states_autostart
ON process_states(user_id, auto_start)
WHERE auto_start = TRUE;
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **backend/database/models.py** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `auto_start` –≤ –º–æ–¥–µ–ª—å `ProcessState`
- **backend/database/crud.py** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:
  - `get_autostart_processes()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å auto_start=True
  - `set_process_autostart()` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ auto_start –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  - –û–±–Ω–æ–≤–ª–µ–Ω `set_process_running()` - —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `auto_start`

- **backend/api/main.py** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `autostart_schedulers()` –∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
  - `/api/control/scheduler/start` - –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `auto_start=True`
  - `/api/control/scheduler/stop` - –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `auto_start=False`
  - Startup event - –≤—ã–∑—ã–≤–∞–µ—Ç `autostart_schedulers()` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å `auto_start=True`

## –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã

### –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (–ø–µ—Ä–≤—ã–π —Ä–∞–∑ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —á–µ—Ä–µ–∑ UI –∏–ª–∏ API: `POST /api/control/scheduler/start`
2. –°–∏—Å—Ç–µ–º–∞:
   - –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ë–î: `status='running'`, `auto_start=True`, –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç PID
3. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

1. –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `autostart_schedulers()`
2. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –≤ `process_states` –≥–¥–µ `status='running'`
3. –î–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–∫–æ–π –∑–∞–ø–∏—Å–∏:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω (–ø–æ PID)
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–æ–≤–æ —Å –Ω–æ–≤—ã–º PID
   - –û–±–Ω–æ–≤–ª—è–µ—Ç PID –≤ –ë–î, —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–µ—Ç—Å—è `running`
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞–ª–∏ –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —á–µ—Ä–µ–∑ UI –∏–ª–∏ API: `POST /api/control/scheduler/stop`
2. –°–∏—Å—Ç–µ–º–∞:
   - –£–±–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ë–î: `status='stopped'`, `auto_start=False`
3. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ —ç—Ç–æ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ù–ï –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ß–µ—Ä–µ–∑ DBeaver

1. –û—Ç–∫—Ä–æ–π—Ç–µ DBeaver –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `migrations/add_scheduler_autostart.sql`
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç (Ctrl+Enter –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ Execute)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
   ```sql
   -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª—è
   SELECT column_name, data_type, column_default
   FROM information_schema.columns
   WHERE table_name = 'process_states'
   AND column_name = 'auto_start';

   -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–∞
   SELECT indexname, indexdef
   FROM pg_indexes
   WHERE tablename = 'process_states'
   AND indexname = 'ix_process_states_autostart';
   ```

### –ß–µ—Ä–µ–∑ psql

```bash
psql -U your_username -d your_database -f migrations/add_scheduler_autostart.sql
```

### –ß–µ—Ä–µ–∑ Python

```python
from database import SessionLocal

db = SessionLocal()
with open('migrations/add_scheduler_autostart.sql', 'r') as f:
    sql = f.read()
    db.execute(sql)
    db.commit()
db.close()
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ –ë–î

```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'running' (–æ–Ω–∏ –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ)
SELECT id, user_id, name, status, pid, started_at
FROM process_states
WHERE status = 'running'
ORDER BY user_id, name;
```

### 2. –ü–æ—à–∞–≥–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —á–µ—Ä–µ–∑ UI –∏–ª–∏ API:
   ```bash
   curl -X POST http://localhost:8000/api/control/scheduler/start \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î:
   ```sql
   SELECT name, status, auto_start, pid
   FROM process_states
   WHERE name LIKE 'scheduler_%';
   ```
   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `status='running'`, `auto_start=true`, `pid` —É–∫–∞–∑–∞–Ω

**–®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä (Docker –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ)

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
   ```
   üöÄ Auto-starting processes with auto_start enabled...
   üîç Found 1 processes in 'running' state
   ‚úÖ scheduler auto-started for user username (PID: 12345) - was 'running' in DB
   ```

5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î —á—Ç–æ PID –æ–±–Ω–æ–≤–∏–ª—Å—è:
   ```sql
   SELECT name, status, pid, started_at, updated_at
   FROM process_states
   WHERE name LIKE 'scheduler_%';
   ```
   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: –Ω–æ–≤—ã–π `pid`, `updated_at` –æ–±–Ω–æ–≤–ª–µ–Ω, `status='running'`

**–®–∞–≥ 3: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞**
6. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —á–µ—Ä–µ–∑ UI –∏–ª–∏ API:
   ```bash
   curl -X POST http://localhost:8000/api/control/scheduler/stop \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```

7. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î:
   ```sql
   SELECT name, status, auto_start, pid
   FROM process_states
   WHERE name LIKE 'scheduler_%';
   ```
   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `status='stopped'`, `auto_start=false`, `pid=NULL`

**–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
8. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä

9. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```
   üöÄ Auto-starting processes with auto_start enabled...
   ‚ÑπÔ∏è  No processes in 'running' state to auto-start
   ```

10. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ù–ï –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è:
- `scheduler` - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- `scaling_scheduler` - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- `bot` - Telegram –±–æ—Ç
- `analysis` - –ø—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –§–ª–∞–≥ `auto_start` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ/–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ü—Ä–∏ —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ `auto_start` –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ü—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è `VK_ADS_USER_ID` –∏ `VK_ADS_USERNAME`

## Troubleshooting

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ –ë–î:**
   ```sql
   SELECT name, status, auto_start, pid, started_at, stopped_at
   FROM process_states
   WHERE name LIKE 'scheduler_%';
   ```

   –ï—Å–ª–∏ `status='stopped'` ‚Üí —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –±—ã–ª –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–∏—Å–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
   - –ï—Å–ª–∏ –Ω–∞—à–ª–∏—Å—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `running`, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ

3. **–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞:**
   ```sql
   SELECT column_name FROM information_schema.columns
   WHERE table_name = 'process_states' AND column_name = 'auto_start';
   ```

### –í—Ä—É—á–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ:

```sql
UPDATE process_states
SET status = 'running', auto_start = TRUE
WHERE name = 'scheduler_1' AND user_id = 1;
```

### –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–≤

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:

```sql
UPDATE process_states
SET status = 'stopped', auto_start = FALSE
WHERE status = 'running';
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

```sql
SELECT u.username, ps.name, ps.status, ps.pid, ps.started_at
FROM process_states ps
JOIN users u ON ps.user_id = u.id
WHERE ps.status = 'running'
ORDER BY u.username, ps.name;
```
